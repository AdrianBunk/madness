/* xc_c_vwn5.f -- translated by f2c (version 20050501).
   You must link the resulting object file with libf2c:
	on Microsoft Windows system, link with libf2c.lib;
	on Linux or Unix systems, link with .../path/to/libf2c.a -lm
	or, if you install libf2c.a in a standard place, with -lf2c -lm
	-- in that order, at the end of the command line, as in
		cc *.o -lf2c -lm
	Source for libf2c is in /netlib/f2c/libf2c.zip, e.g.,

		http://www.netlib.org/f2c/libf2c.zip
*/

#include "f2c.h"

/* Table of constant values */

static doublereal c_b2 = .16666666666666666;
static doublereal c_b3 = .33333333333333331;

/* :C_VWN5subrstart */
/*    Generated: Tue Mar  9 15:23:35 GMT 2004 */
/* Subroutine */ int uks_c_vwn5__(integer *ideriv, integer *npt, doublereal *
	rhoa1, doublereal *rhob1, doublereal *sigmaaa1, doublereal *sigmabb1, 
	doublereal *sigmaab1, doublereal *zk, doublereal *vrhoa, doublereal *
	vrhob, doublereal *vsigmaaa, doublereal *vsigmabb, doublereal *
	vsigmaab, doublereal *v2rhoa2, doublereal *v2rhob2, doublereal *
	v2rhoab, doublereal *v2rhoasigmaaa, doublereal *v2rhoasigmaab, 
	doublereal *v2rhoasigmabb, doublereal *v2rhobsigmabb, doublereal *
	v2rhobsigmaab, doublereal *v2rhobsigmaaa, doublereal *v2sigmaaa2, 
	doublereal *v2sigmaaaab, doublereal *v2sigmaaabb, doublereal *
	v2sigmaab2, doublereal *v2sigmaabbb, doublereal *v2sigmabb2)
{
    /* System generated locals */
    integer i__1;
    doublereal d__1, d__2;

    /* Builtin functions */
    double pow_dd(doublereal *, doublereal *), log(doublereal), atan(
	    doublereal);

    /* Local variables */
    static integer i__;
    static doublereal s1, t1, t2, t3, t4, t5, t6, t7, t9, t10, t20, t12, t30, 
	    t22, t33, t16, t25, t18, t19, t28, t26, t29, t36, t38, t40, t42, 
	    t43, t44, t45, t48, t49, t55, t58, t63, t66, t68, t78, t79, t81, 
	    t82, t13, t15, t21, t27, t31, t34, t37, t41, t46, t51, t60, t61, 
	    t83, t84, t87, t94, t95, t11, t17, t23, t35, t52, t54, t65, t73, 
	    t74, t77, t80, t85, t93, t100, t104, t105, t107, t110, t111, t114,
	     t115, t116, t118, t119, t121, t125, t127, t129, t130, t136, t147,
	     t152, t153, t156, t163, t164, t183, t200, t201, t204, t211, t212,
	     t237, t253, t47, t56, t69, t72, t76, t90, t91, t92, t96, t98, 
	    t99, t101, t103, t106, t109, t112, t120, t122, t123, t128, t137, 
	    t141, t143, rho, t149, t150, t154, t192, t205, t220, t222, t227, 
	    t263, t97, t117, t124, t126, t131, t133, t134, t138, t144, t145, 
	    t146, t159, t160, t165, t167, t168, t172, t175, t178, t179, t180, 
	    t184, t185, t187, t190, t193, t194, t195, t197, t202, t207, t208, 
	    t213, t215, t216, t223, t226, t228, t234, t238, t239, t242, t243, 
	    t246, t249, t250, t254, t255, t256, t257, t261, t262, t265, t266, 
	    t269, t272, t273, t277, t278, t285, t286, t287, t290, t300, t303, 
	    t304, t305, t307, t309, t311, t313, t317, t318, t320, t323, t324, 
	    t325, t326, t327, t328, t329, t331, t333, t342, rhoa, rhob, t344, 
	    t348, t350, t352, t353, t355, t357, t362, t365, t368, t370, t375, 
	    t376, t379, t382, t384, t388, t391, t409, t416, t418, t421, t430, 
	    t432, t437, t453, t462, t466, t498, t524, t533, t535, t540, t556, 
	    t565, t569, t611, t620, t637, t638, t639, t647, t648, t652, t653, 
	    t655, t660, t664;


/*     S.H. Vosko, L. Wilk, and M. Nusair */
/*     Accurate spin-dependent electron liquid correlation energies for */
/*     local spin density calculations: a critical analysis */
/*     Can. J. Phys. 58 (1980) 1200-1211 */


/*     CITATION: */

/*     Functionals were obtained from the Density Functional Repository */
/*     as developed and distributed by the Quantum Chemistry Group, */
/*     CCLRC Daresbury Laboratory, Daresbury, Cheshire, WA4 4AD */
/*     United Kingdom. Contact Huub van Dam (h.j.j.vandam@dl.ac.uk) or */
/*     Paul Sherwood for further information. */

/*     COPYRIGHT: */

/*     Users may incorporate the source code into software packages and */
/*     redistribute the source code provided the source code is not */
/*     changed in anyway and is properly cited in any documentation or */
/*     publication related to its use. */

/*     ACKNOWLEDGEMENT: */

/*     The source code was generated using Maple 8 through a modified */
/*     version of the dfauto script published in: */

/*        R. Strange, F.R. Manby, P.J. Knowles */
/*        Automatic code generation in density functional theory */
/*        Comp. Phys. Comm. 136 (2001) 310-318. */

    /* Parameter adjustments */
    --v2sigmabb2;
    --v2sigmaabbb;
    --v2sigmaab2;
    --v2sigmaaabb;
    --v2sigmaaaab;
    --v2sigmaaa2;
    --v2rhobsigmaaa;
    --v2rhobsigmaab;
    --v2rhobsigmabb;
    --v2rhoasigmabb;
    --v2rhoasigmaab;
    --v2rhoasigmaaa;
    --v2rhoab;
    --v2rhob2;
    --v2rhoa2;
    --vsigmaab;
    --vsigmabb;
    --vsigmaaa;
    --vrhob;
    --vrhoa;
    --zk;
    --sigmaab1;
    --sigmabb1;
    --sigmaaa1;
    --rhob1;
    --rhoa1;

    /* Function Body */
    if (*ideriv == 0) {
	i__1 = *npt;
	for (i__ = 1; i__ <= i__1; ++i__) {
/* Computing MAX */
	    d__1 = 0., d__2 = rhoa1[i__];
	    rhoa = max(d__1,d__2);
/* Computing MAX */
	    d__1 = 0., d__2 = rhob1[i__];
	    rhob = max(d__1,d__2);
	    rho = rhoa + rhob;
	    if (rho > 1e-20) {
		if (rhoa < 1e-20) {
		    rho = rhob;
		    t1 = 1 / rhob;
		    t2 = pow_dd(&t1, &c_b2);
		    t3 = t2 * .7876233178997433;
/* Computing 2nd power */
		    d__1 = t3 + .10498;
		    t5 = d__1 * d__1;
		    t6 = pow_dd(&t1, &c_b3);
		    t7 = t6 * .6203504908994;
		    t12 = log(t5 / (t7 + t2 * 2.935818660072219 + 12.9352));
		    t16 = 1 / (t7 + t2 * 5.560951426165705 + 18.0578);
		    t19 = log(t6 * .6203504908994 * t16);
		    t25 = atan(4.730926909560113 / (t2 * 1.575246635799487 + 
			    7.06042));
/* Computing 2nd power */
		    d__1 = t3 + .325;
		    t28 = d__1 * d__1;
		    t30 = log(t28 * t16);
		    zk[i__] = rhob * (t12 * 1e-24 + t19 * .01554535 + t25 * 
			    .05249139316978094 + t30 * .002247867095542612);
		} else if (rhob < 1e-20) {
		    rho = rhoa;
		    t1 = 1 / rhoa;
		    t2 = pow_dd(&t1, &c_b2);
		    t3 = t2 * .7876233178997433;
/* Computing 2nd power */
		    d__1 = t3 + .10498;
		    t5 = d__1 * d__1;
		    t6 = pow_dd(&t1, &c_b3);
		    t7 = t6 * .6203504908994;
		    t12 = log(t5 / (t7 + t2 * 2.935818660072219 + 12.9352));
		    t16 = 1 / (t7 + t2 * 5.560951426165705 + 18.0578);
		    t19 = log(t6 * .6203504908994 * t16);
		    t25 = atan(4.730926909560113 / (t2 * 1.575246635799487 + 
			    7.06042));
/* Computing 2nd power */
		    d__1 = t3 + .325;
		    t28 = d__1 * d__1;
		    t30 = log(t28 * t16);
		    zk[i__] = rhoa * (t12 * 1e-24 + t19 * .01554535 + t25 * 
			    .05249139316978094 + t30 * .002247867095542612);
		} else {
/* (.not.(rhoa.lt.tol).and..not.(rhob.lt.tol)) */
		    t1 = 1 / rho;
		    t2 = pow_dd(&t1, &c_b3);
		    t3 = t2 * .6203504908994;
		    t4 = pow_dd(&t1, &c_b2);
		    t7 = 1 / (t3 + t4 * 2.935818660072219 + 12.9352);
		    t10 = log(t2 * .6203504908994 * t7);
		    t12 = t4 * 1.575246635799487;
		    t16 = atan(6.15199081975908 / (t12 + 3.72744));
		    t18 = t4 * .7876233178997433;
/* Computing 2nd power */
		    d__1 = t18 + .10498;
		    t20 = d__1 * d__1;
		    t22 = log(t20 * t7);
		    t26 = 1 / (t3 + t4 * .8908571061768626 + 13.0045);
		    t29 = log(t2 * .6203504908994 * t26);
		    t33 = atan(7.123108917818118 / (t12 + 1.13107));
/* Computing 2nd power */
		    d__1 = t18 + .0047584;
		    t36 = d__1 * d__1;
		    t38 = log(t36 * t26);
		    t40 = t29 + t33 * .3177080047439415 + t38 * 
			    4.140337942820627e-4;
		    t42 = rhoa - rhob * 1.;
		    t43 = t42 * t1;
		    t44 = t43 + 1.;
		    t45 = pow_dd(&t44, &c_b3);
		    t48 = 1. - t43 * 1.;
		    t49 = pow_dd(&t48, &c_b3);
		    t55 = 1 / (t3 + t4 * 5.560951426165705 + 18.0578);
		    t58 = log(t2 * .6203504908994 * t55);
		    t63 = atan(4.730926909560113 / (t12 + 7.06042));
/* Computing 2nd power */
		    d__1 = t18 + .325;
		    t66 = d__1 * d__1;
		    t68 = log(t66 * t55);
/* Computing 2nd power */
		    d__1 = t42;
		    t78 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t78;
		    t79 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = rho;
		    t81 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t81;
		    t82 = d__1 * d__1;
		    zk[i__] = rho * (t10 * .0310907 + t16 * 
			    .03878329487811301 + t22 * 9.690227711544374e-4 - 
			    t40 * .01899772193293833 * (t45 * t44 + t49 * t48 
			    - 2.) * (((t58 * .01554535 + t63 * 
			    .05249139316978094 + t68 * .002247867095542612 - 
			    t10 * .0310907 - t16 * .03878329487811301 - t22 * 
			    9.690227711544374e-4) * -101.257459063883 / t40 - 
			    1.) * t79 / t82 + 1.));
		}
/* rhoa,rhob */
	    } else {
/* rho */
		zk[i__] = 0.;
	    }
/* rho */
	}
    } else if (*ideriv == 1) {
	i__1 = *npt;
	for (i__ = 1; i__ <= i__1; ++i__) {
/* Computing MAX */
	    d__1 = 0., d__2 = rhoa1[i__];
	    rhoa = max(d__1,d__2);
/* Computing MAX */
	    d__1 = 0., d__2 = rhob1[i__];
	    rhob = max(d__1,d__2);
	    rho = rhoa + rhob;
	    if (rho > 1e-20) {
		if (rhoa < 1e-20) {
		    rho = rhob;
		    t1 = 1 / rhob;
		    t2 = pow_dd(&t1, &c_b2);
		    t3 = t2 * .7876233178997433;
		    t4 = t3 + .10498;
/* Computing 2nd power */
		    d__1 = t4;
		    t5 = d__1 * d__1;
		    t6 = pow_dd(&t1, &c_b3);
		    t7 = t6 * .6203504908994;
		    t9 = t7 + t2 * 2.935818660072219 + 12.9352;
		    t10 = 1 / t9;
		    t12 = log(t5 * t10);
		    t13 = t12 * 1e-24;
		    t15 = t7 + t2 * 5.560951426165705 + 18.0578;
		    t16 = 1 / t15;
		    t19 = log(t6 * .6203504908994 * t16);
		    t20 = t19 * .01554535;
		    t21 = t2 * 1.575246635799487;
		    t22 = t21 + 7.06042;
		    t25 = atan(4.730926909560113 / t22);
		    t26 = t25 * .05249139316978094;
		    t27 = t3 + .325;
/* Computing 2nd power */
		    d__1 = t27;
		    t28 = d__1 * d__1;
		    t30 = log(t28 * t16);
		    t31 = t30 * .002247867095542612;
		    zk[i__] = rhob * (t13 + t20 + t26 + t31);
		    vrhoa[i__] = 0.;
/* Computing 2nd power */
		    d__1 = t6;
		    t33 = d__1 * d__1;
		    t34 = 1 / t33;
/* Computing 2nd power */
		    d__1 = rhob;
		    t36 = d__1 * d__1;
		    t37 = 1 / t36;
/* Computing 2nd power */
		    d__1 = t9;
		    t40 = d__1 * d__1;
		    t41 = 1 / t40;
		    t44 = t34 * .2067834969664667 * t37;
/* Computing 2nd power */
		    d__1 = t2;
		    t45 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t45;
		    t46 = d__1 * d__1;
		    t48 = 1 / t46 / t2;
		    t49 = t48 * t37;
		    t51 = -t44 - t49 * .4893031100120365;
		    t55 = 1 / t6;
/* Computing 2nd power */
		    d__1 = t21 + 3.72744;
		    t60 = d__1 * d__1;
		    t61 = 1 / t60;
/* Computing 2nd power */
		    d__1 = t15;
		    t83 = d__1 * d__1;
		    t84 = 1 / t83;
		    t87 = -t44 - t49 * .9268252376942842;
/* Computing 2nd power */
		    d__1 = t22;
		    t94 = d__1 * d__1;
		    t95 = 1 / t94;
		    vrhob[i__] = t13 + t20 + t26 + t31 + rhob * ((t34 * 
			    -.2067834969664667 * t10 * t37 - t6 * 
			    .6203504908994 * t41 * t51) * 2e-22 * t55 * t9 - 
			    t61 * 1e-22 * t48 * t37 / (t61 * 37.8469910464 + 
			    1.) + (t4 * -.2625411059665811 * t10 * t49 - t5 * 
			    1. * t41 * t51) * 1e-24 / t5 * t9 + (t34 * 
			    -.2067834969664667 * t16 * t37 - t6 * 
			    .6203504908994 * t84 * t87) * .02505897912236993 *
			     t55 * t15 + t95 * .06519760588836059 * t48 * t37 
			    / (t95 * 22.3816694236 + 1.) + (t27 * 
			    -.2625411059665811 * t16 * t49 - t28 * 1. * t84 * 
			    t87) * .002247867095542612 / t28 * t15);
		} else if (rhob < 1e-20) {
		    rho = rhoa;
		    t1 = 1 / rhoa;
		    t2 = pow_dd(&t1, &c_b2);
		    t3 = t2 * .7876233178997433;
		    t4 = t3 + .10498;
/* Computing 2nd power */
		    d__1 = t4;
		    t5 = d__1 * d__1;
		    t6 = pow_dd(&t1, &c_b3);
		    t7 = t6 * .6203504908994;
		    t9 = t7 + t2 * 2.935818660072219 + 12.9352;
		    t10 = 1 / t9;
		    t12 = log(t5 * t10);
		    t13 = t12 * 1e-24;
		    t15 = t7 + t2 * 5.560951426165705 + 18.0578;
		    t16 = 1 / t15;
		    t19 = log(t6 * .6203504908994 * t16);
		    t20 = t19 * .01554535;
		    t21 = t2 * 1.575246635799487;
		    t22 = t21 + 7.06042;
		    t25 = atan(4.730926909560113 / t22);
		    t26 = t25 * .05249139316978094;
		    t27 = t3 + .325;
/* Computing 2nd power */
		    d__1 = t27;
		    t28 = d__1 * d__1;
		    t30 = log(t28 * t16);
		    t31 = t30 * .002247867095542612;
		    zk[i__] = rhoa * (t13 + t20 + t26 + t31);
/* Computing 2nd power */
		    d__1 = t6;
		    t33 = d__1 * d__1;
		    t34 = 1 / t33;
/* Computing 2nd power */
		    d__1 = rhoa;
		    t36 = d__1 * d__1;
		    t37 = 1 / t36;
/* Computing 2nd power */
		    d__1 = t9;
		    t40 = d__1 * d__1;
		    t41 = 1 / t40;
		    t44 = t34 * .2067834969664667 * t37;
/* Computing 2nd power */
		    d__1 = t2;
		    t45 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t45;
		    t46 = d__1 * d__1;
		    t48 = 1 / t46 / t2;
		    t49 = t48 * t37;
		    t51 = -t44 - t49 * .4893031100120365;
		    t55 = 1 / t6;
/* Computing 2nd power */
		    d__1 = t21 + 3.72744;
		    t60 = d__1 * d__1;
		    t61 = 1 / t60;
/* Computing 2nd power */
		    d__1 = t15;
		    t83 = d__1 * d__1;
		    t84 = 1 / t83;
		    t87 = -t44 - t49 * .9268252376942842;
/* Computing 2nd power */
		    d__1 = t22;
		    t94 = d__1 * d__1;
		    t95 = 1 / t94;
		    vrhoa[i__] = t13 + t20 + t26 + t31 + rhoa * ((t34 * 
			    -.2067834969664667 * t10 * t37 - t6 * 
			    .6203504908994 * t41 * t51) * 2e-22 * t55 * t9 - 
			    t61 * 1e-22 * t48 * t37 / (t61 * 37.8469910464 + 
			    1.) + (t4 * -.2625411059665811 * t10 * t49 - t5 * 
			    1. * t41 * t51) * 1e-24 / t5 * t9 + (t34 * 
			    -.2067834969664667 * t16 * t37 - t6 * 
			    .6203504908994 * t84 * t87) * .02505897912236993 *
			     t55 * t15 + t95 * .06519760588836059 * t48 * t37 
			    / (t95 * 22.3816694236 + 1.) + (t27 * 
			    -.2625411059665811 * t16 * t49 - t28 * 1. * t84 * 
			    t87) * .002247867095542612 / t28 * t15);
		    vrhob[i__] = 0.;
		} else {
/* (.not.(rhoa.lt.tol).and..not.(rhob.lt.tol)) */
		    t1 = 1 / rho;
		    t2 = pow_dd(&t1, &c_b3);
		    t3 = t2 * .6203504908994;
		    t4 = pow_dd(&t1, &c_b2);
		    t6 = t3 + t4 * 2.935818660072219 + 12.9352;
		    t7 = 1 / t6;
		    t10 = log(t2 * .6203504908994 * t7);
		    t11 = t10 * .0310907;
		    t12 = t4 * 1.575246635799487;
		    t13 = t12 + 3.72744;
		    t16 = atan(6.15199081975908 / t13);
		    t17 = t16 * .03878329487811301;
		    t18 = t4 * .7876233178997433;
		    t19 = t18 + .10498;
/* Computing 2nd power */
		    d__1 = t19;
		    t20 = d__1 * d__1;
		    t22 = log(t20 * t7);
		    t23 = t22 * 9.690227711544374e-4;
		    t25 = t3 + t4 * .8908571061768626 + 13.0045;
		    t26 = 1 / t25;
		    t29 = log(t2 * .6203504908994 * t26);
		    t30 = t12 + 1.13107;
		    t33 = atan(7.123108917818118 / t30);
		    t35 = t18 + .0047584;
/* Computing 2nd power */
		    d__1 = t35;
		    t36 = d__1 * d__1;
		    t38 = log(t36 * t26);
		    t40 = t29 + t33 * .3177080047439415 + t38 * 
			    4.140337942820627e-4;
		    t42 = rhoa - rhob * 1.;
		    t43 = t42 * t1;
		    t44 = t43 + 1.;
		    t45 = pow_dd(&t44, &c_b3);
		    t48 = 1. - t43 * 1.;
		    t49 = pow_dd(&t48, &c_b3);
		    t51 = t45 * t44 + t49 * t48 - 2.;
		    t52 = t40 * t51;
		    t54 = t3 + t4 * 5.560951426165705 + 18.0578;
		    t55 = 1 / t54;
		    t58 = log(t2 * .6203504908994 * t55);
		    t60 = t12 + 7.06042;
		    t63 = atan(4.730926909560113 / t60);
		    t65 = t18 + .325;
/* Computing 2nd power */
		    d__1 = t65;
		    t66 = d__1 * d__1;
		    t68 = log(t66 * t55);
		    t73 = t58 * .01554535 + t63 * .05249139316978094 + t68 * 
			    .002247867095542612 - t10 * .0310907 - t16 * 
			    .03878329487811301 - t22 * 9.690227711544374e-4;
		    t74 = 1 / t40;
		    t77 = t73 * -101.257459063883 * t74 - 1.;
/* Computing 2nd power */
		    d__1 = t42;
		    t78 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t78;
		    t79 = d__1 * d__1;
		    t80 = t77 * t79;
/* Computing 2nd power */
		    d__1 = rho;
		    t81 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t81;
		    t82 = d__1 * d__1;
		    t83 = 1 / t82;
		    t85 = t80 * t83 + 1.;
		    t87 = t52 * .01899772193293833 * t85;
		    zk[i__] = rho * (t11 + t17 + t23 - t87);
		    t93 = t45 * 1.333333333333333 * t1 - t49 * 
			    1.333333333333333 * t1;
		    t100 = t52 * t77 * t78 * t42 * t83;
/* Computing 2nd power */
		    d__1 = t2;
		    t104 = d__1 * d__1;
		    t105 = 1 / t104;
		    t107 = 1 / t81;
/* Computing 2nd power */
		    d__1 = t6;
		    t110 = d__1 * d__1;
		    t111 = 1 / t110;
		    t114 = t105 * .2067834969664667 * t107;
/* Computing 2nd power */
		    d__1 = t4;
		    t115 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t115;
		    t116 = d__1 * d__1;
		    t118 = 1 / t116 / t4;
		    t119 = t118 * t107;
		    t121 = -t114 - t119 * .4893031100120365;
		    t125 = 1 / t2;
		    t127 = (t105 * -.2067834969664667 * t7 * t107 - t2 * 
			    .6203504908994 * t111 * t121) * t125 * t6;
/* Computing 2nd power */
		    d__1 = t13;
		    t129 = d__1 * d__1;
		    t130 = 1 / t129;
		    t136 = t130 * t118 * t107 / (t130 * 37.8469910464 + 1.);
		    t147 = (t19 * -.2625411059665811 * t7 * t119 - t20 * 1. * 
			    t111 * t121) / t20 * t6;
/* Computing 2nd power */
		    d__1 = t25;
		    t152 = d__1 * d__1;
		    t153 = 1 / t152;
		    t156 = -t114 - t119 * .1484761843628104;
/* Computing 2nd power */
		    d__1 = t30;
		    t163 = d__1 * d__1;
		    t164 = 1 / t163;
		    t183 = (t105 * -.2067834969664667 * t26 * t107 - t2 * 
			    .6203504908994 * t153 * t156) * 1.61199195401647 *
			     t125 * t25 + t164 * .5941485651138659 * t118 * 
			    t107 / (t164 * 50.7386806551 + 1.) + (t35 * 
			    -.2625411059665811 * t26 * t119 - t36 * 1. * t153 
			    * t156) * 4.140337942820627e-4 / t36 * t25;
/* Computing 2nd power */
		    d__1 = t54;
		    t200 = d__1 * d__1;
		    t201 = 1 / t200;
		    t204 = -t114 - t119 * .9268252376942842;
/* Computing 2nd power */
		    d__1 = t60;
		    t211 = d__1 * d__1;
		    t212 = 1 / t211;
/* Computing 2nd power */
		    d__1 = t40;
		    t237 = d__1 * d__1;
		    t253 = rho * (t127 * .05011795824473985 + t136 * 
			    .0626408570946439 + t147 * 9.690227711544374e-4 - 
			    t183 * .01899772193293833 * t51 * t85 - t40 * 
			    .01899772193293833 * (t45 * -1.333333333333333 * 
			    t42 * t107 + t49 * 1.333333333333333 * t42 * t107)
			     * t85 - t52 * .01899772193293833 * ((((t105 * 
			    -.2067834969664667 * t55 * t107 - t2 * 
			    .6203504908994 * t201 * t204) * 
			    .02505897912236993 * t125 * t54 + t212 * 
			    .06519760588836059 * t118 * t107 / (t212 * 
			    22.3816694236 + 1.) + (t65 * -.2625411059665811 * 
			    t55 * t119 - t66 * 1. * t201 * t204) * 
			    .002247867095542612 / t66 * t54 - t127 * 
			    .05011795824473985 - t136 * .0626408570946439 - 
			    t147 * 9.690227711544374e-4) * -101.257459063883 *
			     t74 + t73 * 101.257459063883 / t237 * t183) * 
			    t79 * t83 - t80 * 4. / t82 / rho));
		    vrhoa[i__] = rho * (t40 * -.01899772193293833 * t93 * t85 
			    - t100 * .07599088773175333) + t11 + t17 + t23 - 
			    t87 + t253;
		    vrhob[i__] = rho * (t40 * .01899772193293833 * t93 * t85 
			    + t100 * .07599088773175333) + t11 + t17 + t23 - 
			    t87 + t253;
		}
/* rhoa,rhob */
	    } else {
/* rho */
		zk[i__] = 0.;
		vrhoa[i__] = 0.;
		vrhob[i__] = 0.;
	    }
/* rho */
	}
    } else if (*ideriv == 2) {
	i__1 = *npt;
	for (i__ = 1; i__ <= i__1; ++i__) {
/* Computing MAX */
	    d__1 = 0., d__2 = rhoa1[i__];
	    rhoa = max(d__1,d__2);
/* Computing MAX */
	    d__1 = 0., d__2 = rhob1[i__];
	    rhob = max(d__1,d__2);
	    rho = rhoa + rhob;
	    if (rho > 1e-20) {
		if (rhoa < 1e-20) {
		    rho = rhob;
		    t1 = 1 / rhob;
		    t2 = pow_dd(&t1, &c_b2);
		    t3 = t2 * .7876233178997433;
		    t4 = t3 + .10498;
/* Computing 2nd power */
		    d__1 = t4;
		    t5 = d__1 * d__1;
		    t6 = pow_dd(&t1, &c_b3);
		    t7 = t6 * .6203504908994;
		    t9 = t7 + t2 * 2.935818660072219 + 12.9352;
		    t10 = 1 / t9;
		    t12 = log(t5 * t10);
		    t13 = t12 * 1e-24;
		    t15 = t7 + t2 * 5.560951426165705 + 18.0578;
		    t16 = 1 / t15;
		    t19 = log(t6 * .6203504908994 * t16);
		    t20 = t19 * .01554535;
		    t21 = t2 * 1.575246635799487;
		    t22 = t21 + 7.06042;
		    t25 = atan(4.730926909560113 / t22);
		    t26 = t25 * .05249139316978094;
		    t27 = t3 + .325;
/* Computing 2nd power */
		    d__1 = t27;
		    t28 = d__1 * d__1;
		    t30 = log(t28 * t16);
		    t31 = t30 * .002247867095542612;
		    zk[i__] = rhob * (t13 + t20 + t26 + t31);
		    vrhoa[i__] = 0.;
/* Computing 2nd power */
		    d__1 = t6;
		    t33 = d__1 * d__1;
		    t34 = 1 / t33;
		    t35 = t34 * t10;
/* Computing 2nd power */
		    d__1 = rhob;
		    t36 = d__1 * d__1;
		    t37 = 1 / t36;
/* Computing 2nd power */
		    d__1 = t9;
		    t40 = d__1 * d__1;
		    t41 = 1 / t40;
		    t42 = t6 * t41;
		    t44 = t34 * .2067834969664667 * t37;
/* Computing 2nd power */
		    d__1 = t2;
		    t45 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t45;
		    t46 = d__1 * d__1;
		    t47 = t46 * t2;
		    t48 = 1 / t47;
		    t49 = t48 * t37;
		    t51 = -t44 - t49 * .4893031100120365;
		    t55 = 1 / t6;
		    t56 = (t35 * -.2067834969664667 * t37 - t42 * 
			    .6203504908994 * t51) * t55;
/* Computing 2nd power */
		    d__1 = t21 + 3.72744;
		    t60 = d__1 * d__1;
		    t61 = 1 / t60;
		    t65 = 1 / (t61 * 37.8469910464 + 1.);
		    t69 = t4 * t10;
		    t72 = t5 * t41;
		    t76 = 1 / t5;
		    t77 = (t69 * -.2625411059665811 * t49 - t72 * 1. * t51) * 
			    t76;
		    t80 = t34 * t16;
/* Computing 2nd power */
		    d__1 = t15;
		    t83 = d__1 * d__1;
		    t84 = 1 / t83;
		    t85 = t6 * t84;
		    t87 = -t44 - t49 * .9268252376942842;
		    t90 = t80 * -.2067834969664667 * t37 - t85 * 
			    .6203504908994 * t87;
		    t91 = t90 * t55;
		    t92 = t91 * t15;
/* Computing 2nd power */
		    d__1 = t22;
		    t94 = d__1 * d__1;
		    t95 = 1 / t94;
		    t96 = t95 * t48;
		    t98 = t95 * 22.3816694236 + 1.;
		    t99 = 1 / t98;
		    t101 = t96 * t37 * t99;
		    t103 = t27 * t16;
		    t106 = t28 * t84;
		    t109 = t103 * -.2625411059665811 * t49 - t106 * 1. * t87;
		    t110 = 1 / t28;
		    t111 = t109 * t110;
		    t112 = t111 * t15;
		    vrhob[i__] = t13 + t20 + t26 + t31 + rhob * (t56 * 2e-22 *
			     t9 - t61 * 1e-22 * t48 * t37 * t65 + t77 * 1e-24 
			    * t9 + t92 * .02505897912236993 + t101 * 
			    .06519760588836059 + t112 * .002247867095542612);
		    v2rhoa2[i__] = 0.;
		    v2rhoab[i__] = 0.;
		    t120 = 1 / t47 / t1;
/* Computing 2nd power */
		    d__1 = t36;
		    t122 = d__1 * d__1;
		    t123 = 1 / t122;
		    t128 = 1 / t33 / t1;
		    t130 = t128 * t10 * t123;
		    t137 = 1 / t36 / rhob;
		    t141 = 1 / t40 / t9;
/* Computing 2nd power */
		    d__1 = t51;
		    t143 = d__1 * d__1;
		    t147 = t128 * .1378556646443111 * t123;
		    t149 = t34 * .4135669939329333 * t137;
		    t150 = t120 * t123;
		    t152 = t48 * t137;
		    t154 = -t147 + t149 - t150 * .4077525916766971 + t152 * 
			    .978606220024073;
		    t192 = t123 * t99;
/* Computing 2nd power */
		    d__1 = t94;
		    t201 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t98;
		    t205 = d__1 * d__1;
		    t211 = t128 * t16 * t123;
		    t220 = 1 / t83 / t15;
/* Computing 2nd power */
		    d__1 = t87;
		    t222 = d__1 * d__1;
		    t227 = -t147 + t149 - t150 * .7723543647452368 + t152 * 
			    1.853650475388568;
		    s1 = t61 * 1e-22 * t120 * t123 * t65 + (t130 * 
			    -.1378556646443111 + t34 * .4135669939329333 * 
			    t41 * t37 * t51 + t35 * .4135669939329333 * t137 
			    + t6 * 1.2407009817988 * t141 * t143 - t42 * 
			    .6203504908994 * t154) * 2e-22 * t55 * t9 + t56 * 
			    2e-22 * t51 + (t130 * .03446391616107778 + t4 * 
			    .5250822119331622 * t41 * t49 * t51 - t69 * 
			    .2187842549721509 * t150 + t69 * 
			    .5250822119331622 * t152 + t5 * 2. * t141 * t143 
			    - t72 * 1. * t154) * 1e-24 * t76 * t9 + t77 * 
			    1e-24 * t51 + t90 * .008352993040789975 / t6 / t1 
			    * t15 * t37 + .03423410311260694 / t94 / t22 * 
			    t128 * t192;
		    t263 = s1 + t95 * .05433133824030049 * t120 * t192 - t96 *
			     .1303952117767212 * t137 * t99 - 
			    .7662163788798043 / t201 / t22 * t128 * t123 / 
			    t205 + (t211 * -.1378556646443111 + t34 * 
			    .4135669939329333 * t84 * t37 * t87 + t80 * 
			    .4135669939329333 * t137 + t6 * 1.2407009817988 * 
			    t220 * t222 - t85 * .6203504908994 * t227) * 
			    .02505897912236993 * t55 * t15 + t91 * 
			    .02505897912236993 * t87 + (t211 * 
			    .03446391616107778 + t27 * .5250822119331622 * 
			    t84 * t49 * t87 - t103 * .2187842549721509 * t150 
			    + t103 * .5250822119331622 * t152 + t28 * 2. * 
			    t220 * t222 - t106 * 1. * t227) * 
			    .002247867095542612 * t110 * t15 + t109 * 
			    5.901575133296437e-4 / t28 / t27 * t15 * t48 * 
			    t37 + t111 * .002247867095542612 * t87;
		    v2rhob2[i__] = t92 * .05011795824473985 + t101 * 
			    .1303952117767212 + t112 * .004495734191085224 + 
			    rhob * t263;
		} else if (rhob < 1e-20) {
		    rho = rhoa;
		    t1 = 1 / rhoa;
		    t2 = pow_dd(&t1, &c_b2);
		    t3 = t2 * .7876233178997433;
		    t4 = t3 + .10498;
/* Computing 2nd power */
		    d__1 = t4;
		    t5 = d__1 * d__1;
		    t6 = pow_dd(&t1, &c_b3);
		    t7 = t6 * .6203504908994;
		    t9 = t7 + t2 * 2.935818660072219 + 12.9352;
		    t10 = 1 / t9;
		    t12 = log(t5 * t10);
		    t13 = t12 * 1e-24;
		    t15 = t7 + t2 * 5.560951426165705 + 18.0578;
		    t16 = 1 / t15;
		    t19 = log(t6 * .6203504908994 * t16);
		    t20 = t19 * .01554535;
		    t21 = t2 * 1.575246635799487;
		    t22 = t21 + 7.06042;
		    t25 = atan(4.730926909560113 / t22);
		    t26 = t25 * .05249139316978094;
		    t27 = t3 + .325;
/* Computing 2nd power */
		    d__1 = t27;
		    t28 = d__1 * d__1;
		    t30 = log(t28 * t16);
		    t31 = t30 * .002247867095542612;
		    zk[i__] = rhoa * (t13 + t20 + t26 + t31);
/* Computing 2nd power */
		    d__1 = t6;
		    t33 = d__1 * d__1;
		    t34 = 1 / t33;
		    t35 = t34 * t10;
/* Computing 2nd power */
		    d__1 = rhoa;
		    t36 = d__1 * d__1;
		    t37 = 1 / t36;
/* Computing 2nd power */
		    d__1 = t9;
		    t40 = d__1 * d__1;
		    t41 = 1 / t40;
		    t42 = t6 * t41;
		    t44 = t34 * .2067834969664667 * t37;
/* Computing 2nd power */
		    d__1 = t2;
		    t45 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t45;
		    t46 = d__1 * d__1;
		    t47 = t46 * t2;
		    t48 = 1 / t47;
		    t49 = t48 * t37;
		    t51 = -t44 - t49 * .4893031100120365;
		    t55 = 1 / t6;
		    t56 = (t35 * -.2067834969664667 * t37 - t42 * 
			    .6203504908994 * t51) * t55;
/* Computing 2nd power */
		    d__1 = t21 + 3.72744;
		    t60 = d__1 * d__1;
		    t61 = 1 / t60;
		    t65 = 1 / (t61 * 37.8469910464 + 1.);
		    t69 = t4 * t10;
		    t72 = t5 * t41;
		    t76 = 1 / t5;
		    t77 = (t69 * -.2625411059665811 * t49 - t72 * 1. * t51) * 
			    t76;
		    t80 = t34 * t16;
/* Computing 2nd power */
		    d__1 = t15;
		    t83 = d__1 * d__1;
		    t84 = 1 / t83;
		    t85 = t6 * t84;
		    t87 = -t44 - t49 * .9268252376942842;
		    t90 = t80 * -.2067834969664667 * t37 - t85 * 
			    .6203504908994 * t87;
		    t91 = t90 * t55;
		    t92 = t91 * t15;
/* Computing 2nd power */
		    d__1 = t22;
		    t94 = d__1 * d__1;
		    t95 = 1 / t94;
		    t96 = t95 * t48;
		    t98 = t95 * 22.3816694236 + 1.;
		    t99 = 1 / t98;
		    t101 = t96 * t37 * t99;
		    t103 = t27 * t16;
		    t106 = t28 * t84;
		    t109 = t103 * -.2625411059665811 * t49 - t106 * 1. * t87;
		    t110 = 1 / t28;
		    t111 = t109 * t110;
		    t112 = t111 * t15;
		    vrhoa[i__] = t13 + t20 + t26 + t31 + rhoa * (t56 * 2e-22 *
			     t9 - t61 * 1e-22 * t48 * t37 * t65 + t77 * 1e-24 
			    * t9 + t92 * .02505897912236993 + t101 * 
			    .06519760588836059 + t112 * .002247867095542612);
		    vrhob[i__] = 0.;
		    t120 = 1 / t47 / t1;
/* Computing 2nd power */
		    d__1 = t36;
		    t122 = d__1 * d__1;
		    t123 = 1 / t122;
		    t128 = 1 / t33 / t1;
		    t130 = t128 * t10 * t123;
		    t137 = 1 / t36 / rhoa;
		    t141 = 1 / t40 / t9;
/* Computing 2nd power */
		    d__1 = t51;
		    t143 = d__1 * d__1;
		    t147 = t128 * .1378556646443111 * t123;
		    t149 = t34 * .4135669939329333 * t137;
		    t150 = t120 * t123;
		    t152 = t48 * t137;
		    t154 = -t147 + t149 - t150 * .4077525916766971 + t152 * 
			    .978606220024073;
		    t192 = t123 * t99;
/* Computing 2nd power */
		    d__1 = t94;
		    t201 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t98;
		    t205 = d__1 * d__1;
		    t211 = t128 * t16 * t123;
		    t220 = 1 / t83 / t15;
/* Computing 2nd power */
		    d__1 = t87;
		    t222 = d__1 * d__1;
		    t227 = -t147 + t149 - t150 * .7723543647452368 + t152 * 
			    1.853650475388568;
		    s1 = t61 * 1e-22 * t120 * t123 * t65 + (t130 * 
			    -.1378556646443111 + t34 * .4135669939329333 * 
			    t41 * t37 * t51 + t35 * .4135669939329333 * t137 
			    + t6 * 1.2407009817988 * t141 * t143 - t42 * 
			    .6203504908994 * t154) * 2e-22 * t55 * t9 + t56 * 
			    2e-22 * t51 + (t130 * .03446391616107778 + t4 * 
			    .5250822119331622 * t41 * t49 * t51 - t69 * 
			    .2187842549721509 * t150 + t69 * 
			    .5250822119331622 * t152 + t5 * 2. * t141 * t143 
			    - t72 * 1. * t154) * 1e-24 * t76 * t9 + t77 * 
			    1e-24 * t51 + t90 * .008352993040789975 / t6 / t1 
			    * t15 * t37 + .03423410311260694 / t94 / t22 * 
			    t128 * t192;
		    t263 = s1 + t95 * .05433133824030049 * t120 * t192 - t96 *
			     .1303952117767212 * t137 * t99 - 
			    .7662163788798043 / t201 / t22 * t128 * t123 / 
			    t205 + (t211 * -.1378556646443111 + t34 * 
			    .4135669939329333 * t84 * t37 * t87 + t80 * 
			    .4135669939329333 * t137 + t6 * 1.2407009817988 * 
			    t220 * t222 - t85 * .6203504908994 * t227) * 
			    .02505897912236993 * t55 * t15 + t91 * 
			    .02505897912236993 * t87 + (t211 * 
			    .03446391616107778 + t27 * .5250822119331622 * 
			    t84 * t49 * t87 - t103 * .2187842549721509 * t150 
			    + t103 * .5250822119331622 * t152 + t28 * 2. * 
			    t220 * t222 - t106 * 1. * t227) * 
			    .002247867095542612 * t110 * t15 + t109 * 
			    5.901575133296437e-4 / t28 / t27 * t15 * t48 * 
			    t37 + t111 * .002247867095542612 * t87;
		    v2rhoa2[i__] = t92 * .05011795824473985 + t101 * 
			    .1303952117767212 + t112 * .004495734191085224 + 
			    rhoa * t263;
		    v2rhob2[i__] = 0.;
		    v2rhoab[i__] = 0.;
		} else {
/* (.not.(rhoa.lt.tol).and..not.(rhob.lt.tol)) */
		    t1 = 1 / rho;
		    t2 = pow_dd(&t1, &c_b3);
		    t3 = t2 * .6203504908994;
		    t4 = pow_dd(&t1, &c_b2);
		    t6 = t3 + t4 * 2.935818660072219 + 12.9352;
		    t7 = 1 / t6;
		    t10 = log(t2 * .6203504908994 * t7);
		    t11 = t10 * .0310907;
		    t12 = t4 * 1.575246635799487;
		    t13 = t12 + 3.72744;
		    t16 = atan(6.15199081975908 / t13);
		    t17 = t16 * .03878329487811301;
		    t18 = t4 * .7876233178997433;
		    t19 = t18 + .10498;
/* Computing 2nd power */
		    d__1 = t19;
		    t20 = d__1 * d__1;
		    t22 = log(t20 * t7);
		    t23 = t22 * 9.690227711544374e-4;
		    t25 = t3 + t4 * .8908571061768626 + 13.0045;
		    t26 = 1 / t25;
		    t29 = log(t2 * .6203504908994 * t26);
		    t30 = t12 + 1.13107;
		    t33 = atan(7.123108917818118 / t30);
		    t35 = t18 + .0047584;
/* Computing 2nd power */
		    d__1 = t35;
		    t36 = d__1 * d__1;
		    t38 = log(t36 * t26);
		    t40 = t29 + t33 * .3177080047439415 + t38 * 
			    4.140337942820627e-4;
		    t42 = rhoa - rhob * 1.;
		    t43 = t42 * t1;
		    t44 = t43 + 1.;
		    t45 = pow_dd(&t44, &c_b3);
		    t48 = 1. - t43 * 1.;
		    t49 = pow_dd(&t48, &c_b3);
		    t51 = t45 * t44 + t49 * t48 - 2.;
		    t52 = t40 * t51;
		    t54 = t3 + t4 * 5.560951426165705 + 18.0578;
		    t55 = 1 / t54;
		    t58 = log(t2 * .6203504908994 * t55);
		    t60 = t12 + 7.06042;
		    t63 = atan(4.730926909560113 / t60);
		    t65 = t18 + .325;
/* Computing 2nd power */
		    d__1 = t65;
		    t66 = d__1 * d__1;
		    t68 = log(t66 * t55);
		    t73 = t58 * .01554535 + t63 * .05249139316978094 + t68 * 
			    .002247867095542612 - t10 * .0310907 - t16 * 
			    .03878329487811301 - t22 * 9.690227711544374e-4;
		    t74 = 1 / t40;
		    t77 = t73 * -101.257459063883 * t74 - 1.;
/* Computing 2nd power */
		    d__1 = t42;
		    t78 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t78;
		    t79 = d__1 * d__1;
		    t80 = t77 * t79;
/* Computing 2nd power */
		    d__1 = rho;
		    t81 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t81;
		    t82 = d__1 * d__1;
		    t83 = 1 / t82;
		    t85 = t80 * t83 + 1.;
		    t87 = t52 * .01899772193293833 * t85;
		    zk[i__] = rho * (t11 + t17 + t23 - t87);
		    t93 = t45 * 1.333333333333333 * t1 - t49 * 
			    1.333333333333333 * t1;
		    t94 = t40 * t93;
		    t95 = t94 * t85;
		    t96 = t95 * .01899772193293833;
		    t97 = t78 * t42;
		    t98 = t77 * t97;
		    t99 = t98 * t83;
		    t100 = t52 * t99;
/* Computing 2nd power */
		    d__1 = t2;
		    t104 = d__1 * d__1;
		    t105 = 1 / t104;
		    t106 = t105 * t7;
		    t107 = 1 / t81;
/* Computing 2nd power */
		    d__1 = t6;
		    t110 = d__1 * d__1;
		    t111 = 1 / t110;
		    t112 = t2 * t111;
		    t114 = t105 * .2067834969664667 * t107;
/* Computing 2nd power */
		    d__1 = t4;
		    t115 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t115;
		    t116 = d__1 * d__1;
		    t117 = t116 * t4;
		    t118 = 1 / t117;
		    t119 = t118 * t107;
		    t121 = -t114 - t119 * .4893031100120365;
		    t124 = t106 * -.2067834969664667 * t107 - t112 * 
			    .6203504908994 * t121;
		    t125 = 1 / t2;
		    t126 = t124 * t125;
		    t127 = t126 * t6;
/* Computing 2nd power */
		    d__1 = t13;
		    t129 = d__1 * d__1;
		    t130 = 1 / t129;
		    t131 = t130 * t118;
		    t133 = t130 * 37.8469910464 + 1.;
		    t134 = 1 / t133;
		    t136 = t131 * t107 * t134;
		    t138 = t19 * t7;
		    t141 = t20 * t111;
		    t144 = t138 * -.2625411059665811 * t119 - t141 * 1. * 
			    t121;
		    t145 = 1 / t20;
		    t146 = t144 * t145;
		    t147 = t146 * t6;
		    t149 = t105 * t26;
/* Computing 2nd power */
		    d__1 = t25;
		    t152 = d__1 * d__1;
		    t153 = 1 / t152;
		    t154 = t2 * t153;
		    t156 = -t114 - t119 * .1484761843628104;
		    t159 = t149 * -.2067834969664667 * t107 - t154 * 
			    .6203504908994 * t156;
		    t160 = t159 * t125;
/* Computing 2nd power */
		    d__1 = t30;
		    t163 = d__1 * d__1;
		    t164 = 1 / t163;
		    t165 = t164 * t118;
		    t167 = t164 * 50.7386806551 + 1.;
		    t168 = 1 / t167;
		    t172 = t35 * t26;
		    t175 = t36 * t153;
		    t178 = t172 * -.2625411059665811 * t119 - t175 * 1. * 
			    t156;
		    t179 = 1 / t36;
		    t180 = t178 * t179;
		    t183 = t160 * 1.61199195401647 * t25 + t165 * 
			    .5941485651138659 * t107 * t168 + t180 * 
			    4.140337942820627e-4 * t25;
		    t184 = t183 * t51;
		    t185 = t184 * t85;
		    t187 = t45 * t42;
		    t190 = t49 * t42;
		    t193 = t187 * -1.333333333333333 * t107 + t190 * 
			    1.333333333333333 * t107;
		    t194 = t40 * t193;
		    t195 = t194 * t85;
		    t197 = t105 * t55;
/* Computing 2nd power */
		    d__1 = t54;
		    t200 = d__1 * d__1;
		    t201 = 1 / t200;
		    t202 = t2 * t201;
		    t204 = -t114 - t119 * .9268252376942842;
		    t207 = t197 * -.2067834969664667 * t107 - t202 * 
			    .6203504908994 * t204;
		    t208 = t207 * t125;
/* Computing 2nd power */
		    d__1 = t60;
		    t211 = d__1 * d__1;
		    t212 = 1 / t211;
		    t213 = t212 * t118;
		    t215 = t212 * 22.3816694236 + 1.;
		    t216 = 1 / t215;
		    t220 = t65 * t55;
		    t223 = t66 * t201;
		    t226 = t220 * -.2625411059665811 * t119 - t223 * 1. * 
			    t204;
		    t227 = 1 / t66;
		    t228 = t226 * t227;
		    t234 = t208 * .02505897912236993 * t54 + t213 * 
			    .06519760588836059 * t107 * t216 + t228 * 
			    .002247867095542612 * t54 - t127 * 
			    .05011795824473985 - t136 * .0626408570946439 - 
			    t147 * 9.690227711544374e-4;
/* Computing 2nd power */
		    d__1 = t40;
		    t237 = d__1 * d__1;
		    t238 = 1 / t237;
		    t239 = t73 * t238;
		    t242 = t234 * -101.257459063883 * t74 + t239 * 
			    101.257459063883 * t183;
		    t243 = t242 * t79;
		    t246 = 1 / t82 / rho;
		    t249 = t243 * t83 - t80 * 4. * t246;
		    t250 = t52 * t249;
		    t253 = rho * (t127 * .05011795824473985 + t136 * 
			    .0626408570946439 + t147 * 9.690227711544374e-4 - 
			    t185 * .01899772193293833 - t195 * 
			    .01899772193293833 - t250 * .01899772193293833);
		    vrhoa[i__] = rho * (-t96 - t100 * .07599088773175333) + 
			    t11 + t17 + t23 - t87 + t253;
		    t254 = -t93;
		    t255 = t40 * t254;
		    t256 = t255 * t85;
		    t257 = t256 * .01899772193293833;
		    vrhob[i__] = rho * (-t257 + t100 * .07599088773175333) + 
			    t11 + t17 + t23 - t87 + t253;
/* Computing 2nd power */
		    d__1 = t45;
		    t261 = d__1 * d__1;
		    t262 = 1 / t261;
/* Computing 2nd power */
		    d__1 = t49;
		    t265 = d__1 * d__1;
		    t266 = 1 / t265;
		    t269 = t262 * .4444444444444444 * t107 + t266 * 
			    .4444444444444444 * t107;
		    t272 = t40 * .01899772193293833 * t269 * t85;
		    t273 = t94 * t99;
		    t277 = t52 * t77 * t78 * t83;
		    t278 = t277 * .22797266319526;
		    t285 = t183 * .01899772193293833 * t93 * t85;
		    t286 = t184 * t99;
		    t287 = t286 * .07599088773175333;
		    t290 = 1 / t81 / rho;
		    t300 = t262 * -.4444444444444444 * t42 * t290 - t45 * 
			    1.333333333333333 * t107 - t266 * 
			    .4444444444444444 * t42 * t290 + t49 * 
			    1.333333333333333 * t107;
		    t303 = t40 * .01899772193293833 * t300 * t85;
		    t304 = t194 * t99;
		    t305 = t304 * .07599088773175333;
		    t307 = t94 * .01899772193293833 * t249;
		    t309 = t242 * t97 * t83;
		    t311 = t98 * t246;
		    t313 = t309 * 4. - t311 * 16.;
		    t317 = rho * (-t285 - t287 - t303 - t305 - t307 - t52 * 
			    .01899772193293833 * t313);
		    t318 = t52 * t309;
		    t320 = t52 * t311;
		    t323 = rho * (-t285 - t303 - t307 - t287 - t305 - t318 * 
			    .07599088773175333 + t320 * .3039635509270133);
		    t324 = t127 * .1002359164894797;
		    t325 = t136 * .1252817141892878;
		    t326 = t147 * .001938045542308875;
		    t327 = t185 * .03799544386587666;
		    t328 = t195 * .03799544386587666;
		    t329 = t250 * .03799544386587666;
		    t331 = 1 / t104 / t1;
		    t333 = t331 * t7 * t83;
		    t342 = 1 / t110 / t6;
/* Computing 2nd power */
		    d__1 = t121;
		    t344 = d__1 * d__1;
		    t348 = t331 * .1378556646443111 * t83;
		    t350 = t105 * .4135669939329333 * t290;
		    t352 = 1 / t117 / t1;
		    t353 = t352 * t83;
		    t355 = t118 * t290;
		    t357 = -t348 + t350 - t353 * .4077525916766971 + t355 * 
			    .978606220024073;
		    t362 = (t333 * -.1378556646443111 + t105 * 
			    .4135669939329333 * t111 * t107 * t121 + t106 * 
			    .4135669939329333 * t290 + t2 * 1.2407009817988 * 
			    t342 * t344 - t112 * .6203504908994 * t357) * 
			    t125 * t6;
		    t365 = 1 / t2 / t1;
		    t368 = t124 * t365 * t6 * t107;
		    t370 = t126 * t121;
		    t375 = t83 * t134;
		    t376 = 1 / t129 / t13 * t331 * t375;
		    t379 = t130 * t352 * t375;
		    t382 = t131 * t290 * t134;
/* Computing 2nd power */
		    d__1 = t129;
		    t384 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t133;
		    t388 = d__1 * d__1;
		    t391 = 1 / t384 / t13 * t331 * t83 / t388;
		    t409 = (t333 * .03446391616107778 + t19 * 
			    .5250822119331622 * t111 * t119 * t121 - t138 * 
			    .2187842549721509 * t353 + t138 * 
			    .5250822119331622 * t355 + t20 * 2. * t342 * t344 
			    - t141 * 1. * t357) * t145 * t6;
		    t416 = t144 / t20 / t19 * t6 * t118 * t107;
		    t418 = t146 * t121;
		    t421 = t331 * t26 * t83;
		    t430 = 1 / t152 / t25;
/* Computing 2nd power */
		    d__1 = t156;
		    t432 = d__1 * d__1;
		    t437 = -t348 + t350 - t353 * .1237301536356754 + t355 * 
			    .2969523687256209;
		    t453 = t83 * t168;
/* Computing 2nd power */
		    d__1 = t163;
		    t462 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t167;
		    t466 = d__1 * d__1;
		    t498 = (t421 * -.1378556646443111 + t105 * 
			    .4135669939329333 * t153 * t107 * t156 + t149 * 
			    .4135669939329333 * t290 + t2 * 1.2407009817988 * 
			    t430 * t432 - t154 * .6203504908994 * t437) * 
			    1.61199195401647 * t125 * t25 + t159 * 
			    .5373306513388232 * t365 * t25 * t107 + t160 * 
			    1.61199195401647 * t156 + .3119768427869032 / 
			    t163 / t30 * t331 * t453 + t164 * 
			    .495123804261555 * t352 * t453 - t165 * 
			    1.188297130227732 * t290 * t168 - 
			    15.82929339795102 / t462 / t30 * t331 * t83 / 
			    t466 + (t421 * .03446391616107778 + t35 * 
			    .5250822119331622 * t153 * t119 * t156 - t172 * 
			    .2187842549721509 * t353 + t172 * 
			    .5250822119331622 * t355 + t36 * 2. * t430 * t432 
			    - t175 * 1. * t437) * 4.140337942820627e-4 * t179 
			    * t25 + t178 * 1.087008902583527e-4 / t36 / t35 * 
			    t25 * t118 * t107 + t180 * 4.140337942820627e-4 * 
			    t156;
		    t524 = t331 * t55 * t83;
		    t533 = 1 / t200 / t54;
/* Computing 2nd power */
		    d__1 = t204;
		    t535 = d__1 * d__1;
		    t540 = -t348 + t350 - t353 * .7723543647452368 + t355 * 
			    1.853650475388568;
		    t556 = t83 * t216;
/* Computing 2nd power */
		    d__1 = t211;
		    t565 = d__1 * d__1;
/* Computing 2nd power */
		    d__1 = t215;
		    t569 = d__1 * d__1;
		    s1 = (t524 * -.1378556646443111 + t105 * 
			    .4135669939329333 * t201 * t107 * t204 + t197 * 
			    .4135669939329333 * t290 + t2 * 1.2407009817988 * 
			    t533 * t535 - t202 * .6203504908994 * t540) * 
			    .02505897912236993 * t125 * t54 + t207 * 
			    .008352993040789975 * t365 * t54 * t107 + t208 * 
			    .02505897912236993 * t204 + .03423410311260694 / 
			    t211 / t60 * t331 * t556 + t212 * 
			    .05433133824030049 * t352 * t556 - t213 * 
			    .1303952117767212 * t290 * t216 - 
			    .7662163788798043 / t565 / t60 * t331 * t83 / 
			    t569 + (t524 * .03446391616107778 + t65 * 
			    .5250822119331622 * t201 * t119 * t204 - t220 * 
			    .2187842549721509 * t353 + t220 * 
			    .5250822119331622 * t355 + t66 * 2. * t533 * t535 
			    - t223 * 1. * t540) * .002247867095542612 * t227 *
			     t54 + t226 * 5.901575133296437e-4 / t66 / t65 * 
			    t54 * t118 * t107 + t228 * .002247867095542612 * 
			    t204;
		    t611 = s1 - t362 * .05011795824473985 - t368 * 
			    .01670598608157995 - t370 * .05011795824473985 - 
			    t376 * .03289159980064473 - t379 * 
			    .05220071424553658 + t382 * .1252817141892878 + 
			    t391 * 1.244848083156773 - t409 * 
			    9.690227711544374e-4 - t416 * 
			    2.544083100456872e-4 - t418 * 
			    9.690227711544374e-4;
/* Computing 2nd power */
		    d__1 = t183;
		    t620 = d__1 * d__1;
		    t637 = t362 * .05011795824473985 + t368 * 
			    .01670598608157995 + t370 * .05011795824473985 + 
			    t376 * .03289159980064473 + t379 * 
			    .05220071424553658 - t382 * .1252817141892878 - 
			    t391 * 1.244848083156773 + t409 * 
			    9.690227711544374e-4 + t416 * 
			    2.544083100456872e-4 + t418 * 
			    9.690227711544374e-4 - t498 * .01899772193293833 *
			     t51 * t85 - t183 * .03799544386587666 * t193 * 
			    t85 - t184 * .03799544386587666 * t249 - t40 * 
			    .01899772193293833 * (t262 * .4444444444444444 * 
			    t78 * t83 + t187 * 2.666666666666667 * t290 + 
			    t266 * .4444444444444444 * t78 * t83 - t190 * 
			    2.666666666666667 * t290) * t85 - t194 * 
			    .03799544386587666 * t249 - t52 * 
			    .01899772193293833 * ((t611 * -101.257459063883 * 
			    t74 + t234 * 202.5149181277661 * t238 * t183 - 
			    t73 * 202.5149181277661 / t237 / t40 * t620 + 
			    t239 * 101.257459063883 * t498) * t79 * t83 - 
			    t243 * 8. * t246 + t80 * 20. / t82 / t81);
		    t638 = rho * t637;
		    v2rhoa2[i__] = rho * (-t272 - t273 * .1519817754635067 - 
			    t278) - t95 * .03799544386587666 - t100 * 
			    .1519817754635067 + t317 + t323 + t324 + t325 + 
			    t326 - t327 - t328 - t329 + t638;
		    t639 = t255 * t99;
		    t647 = t183 * .01899772193293833 * t254 * t85;
		    t648 = t286 * .07599088773175333;
		    t652 = t40 * -.01899772193293833 * t300 * t85;
		    t653 = t304 * .07599088773175333;
		    t655 = t255 * .01899772193293833 * t249;
		    t660 = rho * (-t647 + t648 - t652 + t653 - t655 + t52 * 
			    .01899772193293833 * t313);
		    t664 = rho * (-t647 - t652 - t655 + t648 + t653 + t318 * 
			    .07599088773175333 - t320 * .3039635509270133);
		    v2rhob2[i__] = rho * (-t272 + t639 * .1519817754635067 - 
			    t278) - t256 * .03799544386587666 + t100 * 
			    .1519817754635067 + t660 + t664 + t324 + t325 + 
			    t326 - t327 - t328 - t329 + t638;
		    v2rhoab[i__] = rho * (t40 * .01899772193293833 * t269 * 
			    t85 + t273 * .07599088773175333 - t639 * 
			    .07599088773175333 + t277 * .22797266319526) - 
			    t257 + t660 * .5 - t96 + t323 * .5 + t324 + t325 
			    + t326 - t327 - t328 - t329 + t638 + t317 * .5 + 
			    t664 * .5;
		}
/* rhoa,rhob */
	    } else {
/* rho */
		zk[i__] = 0.;
		vrhoa[i__] = 0.;
		vrhob[i__] = 0.;
		v2rhoa2[i__] = 0.;
		v2rhob2[i__] = 0.;
		v2rhoab[i__] = 0.;
	    }
/* rho */
	}
    }
/* ideriv */
    return 0;
} /* uks_c_vwn5__ */

/* Subroutine */ int rks_c_vwn5__(integer *ideriv, integer *npt, doublereal *
	rhoa1, doublereal *sigmaaa1, doublereal *zk, doublereal *vrhoa, 
	doublereal *vsigmaaa, doublereal *v2rhoa2, doublereal *v2rhoasigmaaa, 
	doublereal *v2sigmaaa2)
{
    /* System generated locals */
    integer i__1;
    doublereal d__1, d__2;

    /* Builtin functions */
    double pow_dd(doublereal *, doublereal *), log(doublereal), atan(
	    doublereal);

    /* Local variables */
    static integer i__;
    static doublereal s1, t1, t2, t4, t6, t7, t10, t20, t11, t22, t13, t23, 
	    t16, t17, t25, t19, t26, t28, t29, t32, t33, t37, t38, t40, t41, 
	    t43, t51, t52, t27, t34, t39, t46, t47, t48, t49, t53, t55, t56, 
	    t58, t60, t63, t66, t67, t68, t69, t77, t79, t80, t81, t88, t92, 
	    t94, t102, t103, t105, t107, t125, t134, t138, rho;


/*     S.H. Vosko, L. Wilk, and M. Nusair */
/*     Accurate spin-dependent electron liquid correlation energies for */
/*     local spin density calculations: a critical analysis */
/*     Can. J. Phys. 58 (1980) 1200-1211 */


/*     CITATION: */

/*     Functionals were obtained from the Density Functional Repository */
/*     as developed and distributed by the Quantum Chemistry Group, */
/*     CCLRC Daresbury Laboratory, Daresbury, Cheshire, WA4 4AD */
/*     United Kingdom. Contact Huub van Dam (h.j.j.vandam@dl.ac.uk) or */
/*     Paul Sherwood for further information. */

/*     COPYRIGHT: */

/*     Users may incorporate the source code into software packages and */
/*     redistribute the source code provided the source code is not */
/*     changed in anyway and is properly cited in any documentation or */
/*     publication related to its use. */

/*     ACKNOWLEDGEMENT: */

/*     The source code was generated using Maple 8 through a modified */
/*     version of the dfauto script published in: */

/*        R. Strange, F.R. Manby, P.J. Knowles */
/*        Automatic code generation in density functional theory */
/*        Comp. Phys. Comm. 136 (2001) 310-318. */

    /* Parameter adjustments */
    --v2sigmaaa2;
    --v2rhoasigmaaa;
    --v2rhoa2;
    --vsigmaaa;
    --vrhoa;
    --zk;
    --sigmaaa1;
    --rhoa1;

    /* Function Body */
    if (*ideriv == 0) {
	i__1 = *npt;
	for (i__ = 1; i__ <= i__1; ++i__) {
/* Computing MAX */
	    d__1 = 0., d__2 = rhoa1[i__];
	    rho = max(d__1,d__2);
	    if (rho > 1e-20) {
		t1 = 1 / rho;
		t2 = pow_dd(&t1, &c_b3);
		t4 = pow_dd(&t1, &c_b2);
		t7 = 1 / (t2 * .6203504908994 + t4 * 2.935818660072219 + 
			12.9352);
		t10 = log(t2 * .6203504908994 * t7);
		t16 = atan(6.15199081975908 / (t4 * 1.575246635799487 + 
			3.72744));
/* Computing 2nd power */
		d__1 = t4 * .7876233178997433 + .10498;
		t20 = d__1 * d__1;
		t22 = log(t20 * t7);
		zk[i__] = rho * (t10 * .0310907 + t16 * .03878329487811301 + 
			t22 * 9.690227711544374e-4);
	    } else {
/* rho */
		zk[i__] = 0.;
	    }
/* rho */
	}
    } else if (*ideriv == 1) {
	i__1 = *npt;
	for (i__ = 1; i__ <= i__1; ++i__) {
/* Computing MAX */
	    d__1 = 0., d__2 = rhoa1[i__];
	    rho = max(d__1,d__2);
	    if (rho > 1e-20) {
		t1 = 1 / rho;
		t2 = pow_dd(&t1, &c_b3);
		t4 = pow_dd(&t1, &c_b2);
		t6 = t2 * .6203504908994 + t4 * 2.935818660072219 + 12.9352;
		t7 = 1 / t6;
		t10 = log(t2 * .6203504908994 * t7);
		t11 = t10 * .0310907;
		t13 = t4 * 1.575246635799487 + 3.72744;
		t16 = atan(6.15199081975908 / t13);
		t17 = t16 * .03878329487811301;
		t19 = t4 * .7876233178997433 + .10498;
/* Computing 2nd power */
		d__1 = t19;
		t20 = d__1 * d__1;
		t22 = log(t20 * t7);
		t23 = t22 * 9.690227711544374e-4;
		zk[i__] = rho * (t11 + t17 + t23);
/* Computing 2nd power */
		d__1 = t2;
		t25 = d__1 * d__1;
		t26 = 1 / t25;
/* Computing 2nd power */
		d__1 = rho;
		t28 = d__1 * d__1;
		t29 = 1 / t28;
/* Computing 2nd power */
		d__1 = t6;
		t32 = d__1 * d__1;
		t33 = 1 / t32;
/* Computing 2nd power */
		d__1 = t4;
		t37 = d__1 * d__1;
/* Computing 2nd power */
		d__1 = t37;
		t38 = d__1 * d__1;
		t40 = 1 / t38 / t4;
		t41 = t40 * t29;
		t43 = t26 * -.2067834969664667 * t29 - t41 * 
			.4893031100120365;
/* Computing 2nd power */
		d__1 = t13;
		t51 = d__1 * d__1;
		t52 = 1 / t51;
		vrhoa[i__] = t11 + t17 + t23 + rho * ((t26 * 
			-.2067834969664667 * t7 * t29 - t2 * .6203504908994 * 
			t33 * t43) * .05011795824473985 / t2 * t6 + t52 * 
			.0626408570946439 * t40 * t29 / (t52 * 37.8469910464 
			+ 1.) + (t19 * -.2625411059665811 * t7 * t41 - t20 * 
			1. * t33 * t43) * 9.690227711544374e-4 / t20 * t6);
	    } else {
/* rho */
		zk[i__] = 0.;
		vrhoa[i__] = 0.;
	    }
/* rho */
	}
    } else if (*ideriv == 2) {
	i__1 = *npt;
	for (i__ = 1; i__ <= i__1; ++i__) {
/* Computing MAX */
	    d__1 = 0., d__2 = rhoa1[i__];
	    rho = max(d__1,d__2);
	    if (rho > 1e-20) {
		t1 = 1 / rho;
		t2 = pow_dd(&t1, &c_b3);
		t4 = pow_dd(&t1, &c_b2);
		t6 = t2 * .6203504908994 + t4 * 2.935818660072219 + 12.9352;
		t7 = 1 / t6;
		t10 = log(t2 * .6203504908994 * t7);
		t11 = t10 * .0310907;
		t13 = t4 * 1.575246635799487 + 3.72744;
		t16 = atan(6.15199081975908 / t13);
		t17 = t16 * .03878329487811301;
		t19 = t4 * .7876233178997433 + .10498;
/* Computing 2nd power */
		d__1 = t19;
		t20 = d__1 * d__1;
		t22 = log(t20 * t7);
		t23 = t22 * 9.690227711544374e-4;
		zk[i__] = rho * (t11 + t17 + t23);
/* Computing 2nd power */
		d__1 = t2;
		t25 = d__1 * d__1;
		t26 = 1 / t25;
		t27 = t26 * t7;
/* Computing 2nd power */
		d__1 = rho;
		t28 = d__1 * d__1;
		t29 = 1 / t28;
/* Computing 2nd power */
		d__1 = t6;
		t32 = d__1 * d__1;
		t33 = 1 / t32;
		t34 = t2 * t33;
/* Computing 2nd power */
		d__1 = t4;
		t37 = d__1 * d__1;
/* Computing 2nd power */
		d__1 = t37;
		t38 = d__1 * d__1;
		t39 = t38 * t4;
		t40 = 1 / t39;
		t41 = t40 * t29;
		t43 = t26 * -.2067834969664667 * t29 - t41 * 
			.4893031100120365;
		t46 = t27 * -.2067834969664667 * t29 - t34 * .6203504908994 * 
			t43;
		t47 = 1 / t2;
		t48 = t46 * t47;
		t49 = t48 * t6;
/* Computing 2nd power */
		d__1 = t13;
		t51 = d__1 * d__1;
		t52 = 1 / t51;
		t53 = t52 * t40;
		t55 = t52 * 37.8469910464 + 1.;
		t56 = 1 / t55;
		t58 = t53 * t29 * t56;
		t60 = t19 * t7;
		t63 = t20 * t33;
		t66 = t60 * -.2625411059665811 * t41 - t63 * 1. * t43;
		t67 = 1 / t20;
		t68 = t66 * t67;
		t69 = t68 * t6;
		vrhoa[i__] = t11 + t17 + t23 + rho * (t49 * 
			.05011795824473985 + t58 * .0626408570946439 + t69 * 
			9.690227711544374e-4);
		t77 = 1 / t25 / t1;
/* Computing 2nd power */
		d__1 = t28;
		t79 = d__1 * d__1;
		t80 = 1 / t79;
		t81 = t77 * t7 * t80;
		t88 = 1 / t28 / rho;
		t92 = 1 / t32 / t6;
/* Computing 2nd power */
		d__1 = t43;
		t94 = d__1 * d__1;
		t102 = 1 / t39 / t1;
		t103 = t102 * t80;
		t105 = t40 * t88;
		t107 = t77 * -.1378556646443111 * t80 + t26 * 
			.4135669939329333 * t88 - t103 * .4077525916766971 + 
			t105 * .978606220024073;
		t125 = t80 * t56;
/* Computing 2nd power */
		d__1 = t51;
		t134 = d__1 * d__1;
/* Computing 2nd power */
		d__1 = t55;
		t138 = d__1 * d__1;
		s1 = t49 * .2004718329789594 + t58 * .2505634283785756;
		v2rhoa2[i__] = s1 + t69 * .00387609108461775 + rho * 2. * ((
			t81 * -.1378556646443111 + t26 * .4135669939329333 * 
			t33 * t29 * t43 + t27 * .4135669939329333 * t88 + t2 *
			 1.2407009817988 * t92 * t94 - t34 * .6203504908994 * 
			t107) * .05011795824473985 * t47 * t6 + t46 * 
			.01670598608157995 / t2 / t1 * t6 * t29 + t48 * 
			.05011795824473985 * t43 + .03289159980064473 / t51 / 
			t13 * t77 * t125 + t52 * .05220071424553658 * t102 * 
			t125 - t53 * .1252817141892878 * t88 * t56 - 
			1.244848083156773 / t134 / t13 * t77 * t80 / t138 + (
			t81 * .03446391616107778 + t19 * .5250822119331622 * 
			t33 * t41 * t43 - t60 * .2187842549721509 * t103 + 
			t60 * .5250822119331622 * t105 + t20 * 2. * t92 * t94 
			- t63 * 1. * t107) * 9.690227711544374e-4 * t67 * t6 
			+ t66 * 2.544083100456872e-4 / t20 / t19 * t6 * t40 * 
			t29 + t68 * 9.690227711544374e-4 * t43);
	    } else {
/* rho */
		zk[i__] = 0.;
		vrhoa[i__] = 0.;
		v2rhoa2[i__] = 0.;
	    }
/* rho */
	}
    }
/* ideriv */
    return 0;
} /* rks_c_vwn5__ */

